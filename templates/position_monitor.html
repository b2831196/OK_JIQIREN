<!-- 持仓状态监听器 -->
<script>
// 监听持仓状态变化 - 全局函数
function updateGlobalPositionStatus(count) {
    console.log('更新全局持仓状态:', count);
    
    // 保存到localStorage
    localStorage.setItem('okxPositionCount', count.toString());
    localStorage.setItem('okxPositionsUpdateTime', new Date().getTime().toString());
    
    // 更新所有页面中的持仓显示
    document.querySelectorAll('.flex-x.nav-li.nav-li-p span:nth-child(2)').forEach(elem => {
        if (elem.parentElement.textContent.includes('执行中')) {
            elem.textContent = `(${count})`;
        }
    });
    
    // 触发持仓更新事件
    // 已删除自定义事件派发
}

// 页面加载完成后自动检查持仓状态
document.addEventListener('DOMContentLoaded', function() {
    // 读取localStorage中的持仓数量
    const savedCount = // 已删除持仓存储代码;
    if (savedCount) {
        updateGlobalPositionStatus(parseInt(savedCount));
    }
    
    // 监听localStorage变化
    window.addEventListener('storage', function(e) {
        if (e.key === 'okxPositionCount') {
            updateGlobalPositionStatus(parseInt(e.newValue || '0'));
        }
    });
});
</script>
